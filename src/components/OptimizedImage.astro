---
import { getCloudinaryUrl } from "../utils/cloudinary.js";

interface Props {
  image: { url?: string; alt?: string };
  variant: string;
  loading?: "lazy" | "eager";
  class?: string;
  quality?: number;
  preferAvif?: boolean;
}

const {
  image,
  variant,
  loading = "lazy",
  class: className,
  quality = 65,
  preferAvif = true,
} = Astro.props;

// Use centralized Cloudinary function
const imageSrc = getCloudinaryUrl(image?.url, variant, {
  quality,
  format: preferAvif ? "avif" : "auto",
});
---

<img
  src={imageSrc}
  alt={image?.alt || `${variant} image`}
  loading={loading}
  class={`w-full object-cover ${className || ""}`}
/>
